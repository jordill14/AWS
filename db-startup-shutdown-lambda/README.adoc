Startup and shutdown AWS RDS with Lambda
========================================

Welcome to your CDK TypeScript project!

This is a blank project for TypeScript development with CDK.

The `cdk.json` file tells the CDK Toolkit how to execute your app.

- Useful commands

 ** `npm run build`   compile typescript to js
 ** `npm run watch`   watch for changes and compile
 ** `npm run test`    perform the jest unit tests
 ** `cdk deploy`      deploy this stack to your default AWS account/region
 ** `cdk diff`        compare deployed stack with current state
 ** `cdk synth`       emits the synthesized CloudFormation template

AWS SAM
-------

- Create a MySQL database

[console.source]
----
ğœ† aws rds create-db-instance --profile personal --db-instance-identifier db-startup-shutdown-lambda-mysql      --db-instance-class db.t2.micro --engine mysql    --allocated-storage 5 --master-username admin  --master-user-password adminPwd
ğœ† aws rds create-db-instance --profile personal --db-instance-identifier db-startup-shutdown-lambda-postgresql --db-instance-class db.t2.micro --engine postgres --allocated-storage 5 --master-username master --master-user-password masterPwd
----

- Setup S3 Bucket

[console.source]
----
ğœ† aws s3 mb --profile personal s3://db-startup-shutdown-lambda-bucket
----

- Test startup remote AWS RDS with Lambda function locally

[console.source]
----
ğœ† sam local invoke --profile personal --no-event DBShutDownFunction
Invoking app.lambdaHandler (nodejs12.x)

Fetching lambci/lambda:nodejs12.x Docker container image......
Mounting /Users/terrence/tmp/db-startup-shutdown-lambda/shutdown as /var/task:ro,delegated inside runtime container
START RequestId: 8bdaa279-ebcf-1d90-3888-989318612005 Version: $LATEST
END RequestId: 8bdaa279-ebcf-1d90-3888-989318612005
REPORT RequestId: 8bdaa279-ebcf-1d90-3888-989318612005	Init Duration: 218.07 ms	Duration: 371.26 ms	Billed Duration: 400 ms	Memory Size: 128 MB	Max Memory Used: 59 MB

{"statusCode":200,"body":{"ResponseMetadata":{"RequestId":"bf5a0ae8-5334-4307-bddb-ad0bcaf30e53"},"DBInstance":{"DBInstanceIdentifier":"db-startup-shutdown-lambda-mysql","DBInstanceClass":"db.t2.micro","Engine":"mysql","DBInstanceStatus":"stopping","MasterUsername":"admin","Endpoint":{"Address":"db-startup-shutdown-lambda-mysql.c4p2iv5uanmr.ap-southeast-2.rds.amazonaws.com","Port":3306,"HostedZoneId":"Z32T0VRHXEXS0V"},"AllocatedStorage":20,"InstanceCreateTime":"2020-02-22T00:33:54.125Z","PreferredBackupWindow":"14:42-15:12","BackupRetentionPeriod":10,"DBSecurityGroups":[],"VpcSecurityGroups":[{"VpcSecurityGroupId":"sg-45a54e3a","Status":"active"}],"DBParameterGroups":[{"DBParameterGroupName":"default.mysql5.7","ParameterApplyStatus":"in-sync"}],"AvailabilityZone":"ap-southeast-2b","DBSubnetGroup":{"DBSubnetGroupName":"default","DBSubnetGroupDescription":"default","VpcId":"vpc-c7331aa0","SubnetGroupStatus":"Complete","Subnets":[{"SubnetIdentifier":"subnet-a53c2dc2","SubnetAvailabilityZone":{"Name":"ap-southeast-2a"},"SubnetStatus":"Active"},{"SubnetIdentifier":"subnet-ea6361a3","SubnetAvailabilityZone":{"Name":"ap-southeast-2b"},"SubnetStatus":"Active"},{"SubnetIdentifier":"subnet-5d0a8a05","SubnetAvailabilityZone":{"Name":"ap-southeast-2c"},"SubnetStatus":"Active"}]},"PreferredMaintenanceWindow":"sat:14:04-sat:14:34","PendingModifiedValues":{},"LatestRestorableTime":"2020-02-22T02:10:00.000Z","MultiAZ":false,"EngineVersion":"5.7.22","AutoMinorVersionUpgrade":true,"ReadReplicaDBInstanceIdentifiers":[],"ReadReplicaDBClusterIdentifiers":[],"LicenseModel":"general-public-license","OptionGroupMemberships":[{"OptionGroupName":"default:mysql-5-7","Status":"in-sync"}],"PubliclyAccessible":true,"StatusInfos":[],"StorageType":"gp2","DbInstancePort":0,"StorageEncrypted":false,"DbiResourceId":"db-S7WTUCM2GN4TESVM5ZCBBQZCUE","CACertificateIdentifier":"rds-ca-2019","DomainMemberships":[],"CopyTagsToSnapshot":false,"MonitoringInterval":0,"DBInstanceArn":"arn:aws:rds:ap-southeast-2:123456789012:db:db-startup-shutdown-lambda-mysql","IAMDatabaseAuthenticationEnabled":false,"PerformanceInsightsEnabled":false,"EnabledCloudwatchLogsExports":[],"ProcessorFeatures":[],"DeletionProtection":false,"AssociatedRoles":[]}}}
----

- Test shutdown remote AWS RDS with Lambda function locally

[console.source]
----
ğœ† sam local invoke --profile personal --no-event DBStartUpFunction
Invoking app.lambdaHandler (nodejs12.x)

Fetching lambci/lambda:nodejs12.x Docker container image......
Mounting /Users/terrence/tmp/db-startup-shutdown-lambda/startup as /var/task:ro,delegated inside runtime container
START RequestId: 5de4dd12-7003-13e7-97c8-0b1dcbf8fb09 Version: $LATEST
END RequestId: 5de4dd12-7003-13e7-97c8-0b1dcbf8fb09
REPORT RequestId: 5de4dd12-7003-13e7-97c8-0b1dcbf8fb09	Init Duration: 215.72 ms	Duration: 515.23 ms	Billed Duration: 600 ms	Memory Size: 128 MB	Max Memory Used: 58 MB

{"statusCode":200,"body":{"ResponseMetadata":{"RequestId":"8352387b-3229-4263-86c8-27b123805720"},"DBInstance":{"DBInstanceIdentifier":"db-startup-shutdown-lambda-mysql","DBInstanceClass":"db.t2.micro","Engine":"mysql","DBInstanceStatus":"starting","MasterUsername":"admin","Endpoint":{"Address":"db-startup-shutdown-lambda-mysql.c4p2iv5uanmr.ap-southeast-2.rds.amazonaws.com","Port":3306,"HostedZoneId":"Z32T0VRHXEXS0V"},"AllocatedStorage":20,"InstanceCreateTime":"2020-02-22T00:33:54.125Z","PreferredBackupWindow":"14:42-15:12","BackupRetentionPeriod":10,"DBSecurityGroups":[],"VpcSecurityGroups":[{"VpcSecurityGroupId":"sg-45a54e3a","Status":"active"}],"DBParameterGroups":[{"DBParameterGroupName":"default.mysql5.7","ParameterApplyStatus":"in-sync"}],"AvailabilityZone":"ap-southeast-2b","DBSubnetGroup":{"DBSubnetGroupName":"default","DBSubnetGroupDescription":"default","VpcId":"vpc-c7331aa0","SubnetGroupStatus":"Complete","Subnets":[{"SubnetIdentifier":"subnet-a53c2dc2","SubnetAvailabilityZone":{"Name":"ap-southeast-2a"},"SubnetStatus":"Active"},{"SubnetIdentifier":"subnet-ea6361a3","SubnetAvailabilityZone":{"Name":"ap-southeast-2b"},"SubnetStatus":"Active"},{"SubnetIdentifier":"subnet-5d0a8a05","SubnetAvailabilityZone":{"Name":"ap-southeast-2c"},"SubnetStatus":"Active"}]},"PreferredMaintenanceWindow":"sat:14:04-sat:14:34","PendingModifiedValues":{},"LatestRestorableTime":"2020-02-22T02:10:00.000Z","MultiAZ":false,"EngineVersion":"5.7.22","AutoMinorVersionUpgrade":true,"ReadReplicaDBInstanceIdentifiers":[],"ReadReplicaDBClusterIdentifiers":[],"LicenseModel":"general-public-license","OptionGroupMemberships":[{"OptionGroupName":"default:mysql-5-7","Status":"in-sync"}],"PubliclyAccessible":true,"StatusInfos":[],"StorageType":"gp2","DbInstancePort":0,"StorageEncrypted":false,"DbiResourceId":"db-S7WTUCM2GN4TESVM5ZCBBQZCUE","CACertificateIdentifier":"rds-ca-2019","DomainMemberships":[],"CopyTagsToSnapshot":false,"MonitoringInterval":0,"DBInstanceArn":"arn:aws:rds:ap-southeast-2:123456789012:db:db-startup-shutdown-lambda-mysql","IAMDatabaseAuthenticationEnabled":false,"PerformanceInsightsEnabled":false,"EnabledCloudwatchLogsExports":[],"ProcessorFeatures":[],"DeletionProtection":false,"AssociatedRoles":[]}}}
----

- Pack AWS Lambda functions

[console.source]
----
ğœ† sam package --profile personal --template-file template.yaml --s3-bucket db-startup-shutdown-lambda-bucket --output-template-file db-startup-shutdown-lambda.template
Uploading to ce5a18943bd319014d6e8c1bd3be393e  596 / 596.0  (100.00%)
Uploading to d31b171ea79cbf6bca71eeb99f1acfaf  598 / 598.0  (100.00%)

Successfully packaged artifacts and wrote output template to file db-startup-shutdown-lambda.template.
Execute the following command to deploy the packaged template
sam deploy --template-file /Users/terrence/tmp/db-startup-shutdown-lambda/db-startup-shutdown-lambda.template --stack-name <YOUR STACK NAME>
----

- Deploy AWS Lambda functions

[console.source]
----
ğœ† sam deploy --profile personal --template-file db-startup-shutdown-lambda.template --stack-name db-startup-shutdown-lambda-stack --capabilities CAPABILITY_IAM

	Deploying with following values
	===============================
	Stack name                 : db-startup-shutdown-lambda-stack
	Region                     : None
	Confirm changeset          : False
	Deployment s3 bucket       : None
	Capabilities               : ["CAPABILITY_IAM"]
	Parameter overrides        : {}

Initiating deployment
=====================

Waiting for changeset to be created..

CloudFormation stack changeset
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Operation                                                                       LogicalResourceId                                                               ResourceType
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
+ Add                                                                           DBFunctionsDeadLetterTopic                                                      AWS::SNS::Topic
+ Add                                                                           DBShutDownFunctionRole                                                          AWS::IAM::Role
+ Add                                                                           DBShutDownFunctionSchedule1Permission                                           AWS::Lambda::Permission
+ Add                                                                           DBShutDownFunctionSchedule1                                                     AWS::Events::Rule
+ Add                                                                           DBShutDownFunction                                                              AWS::Lambda::Function
+ Add                                                                           DBStartUpFunctionRole                                                           AWS::IAM::Role
+ Add                                                                           DBStartUpFunctionSchedule1Permission                                            AWS::Lambda::Permission
+ Add                                                                           DBStartUpFunctionSchedule1                                                      AWS::Events::Rule
+ Add                                                                           DBStartUpFunction                                                               AWS::Lambda::Function
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Changeset created successfully. arn:aws:cloudformation:ap-southeast-2:123456789012:changeSet/samcli-deploy1582338571/8099c305-e102-40b7-9cbe-14a2ab2690a7


2020-02-22 13:29:37 - Waiting for stack create/update to complete

CloudFormation events from changeset
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ResourceStatus                                              ResourceType                                                LogicalResourceId                                           ResourceStatusReason
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE_IN_PROGRESS                                          AWS::SNS::Topic                                             DBFunctionsDeadLetterTopic                                  Resource creation Initiated
CREATE_COMPLETE                                             AWS::SNS::Topic                                             DBFunctionsDeadLetterTopic                                  -
CREATE_IN_PROGRESS                                          AWS::IAM::Role                                              DBStartUpFunctionRole                                       Resource creation Initiated
CREATE_IN_PROGRESS                                          AWS::IAM::Role                                              DBShutDownFunctionRole                                      Resource creation Initiated
CREATE_COMPLETE                                             AWS::IAM::Role                                              DBShutDownFunctionRole                                      -
CREATE_COMPLETE                                             AWS::IAM::Role                                              DBStartUpFunctionRole                                       -
CREATE_IN_PROGRESS                                          AWS::Lambda::Function                                       DBShutDownFunction                                          Resource creation Initiated
CREATE_IN_PROGRESS                                          AWS::Lambda::Function                                       DBStartUpFunction                                           Resource creation Initiated
CREATE_COMPLETE                                             AWS::Lambda::Function                                       DBShutDownFunction                                          -
CREATE_COMPLETE                                             AWS::Lambda::Function                                       DBStartUpFunction                                           -
CREATE_IN_PROGRESS                                          AWS::Events::Rule                                           DBShutDownFunctionSchedule1                                 Resource creation Initiated
CREATE_IN_PROGRESS                                          AWS::Events::Rule                                           DBStartUpFunctionSchedule1                                  Resource creation Initiated
CREATE_COMPLETE                                             AWS::Events::Rule                                           DBShutDownFunctionSchedule1                                 -
CREATE_COMPLETE                                             AWS::Events::Rule                                           DBStartUpFunctionSchedule1                                  -
CREATE_IN_PROGRESS                                          AWS::Lambda::Permission                                     DBShutDownFunctionSchedule1Permission                       Resource creation Initiated
CREATE_IN_PROGRESS                                          AWS::Lambda::Permission                                     DBStartUpFunctionSchedule1Permission                        Resource creation Initiated
CREATE_COMPLETE                                             AWS::Lambda::Permission                                     DBShutDownFunctionSchedule1Permission                       -
CREATE_COMPLETE                                             AWS::Lambda::Permission                                     DBStartUpFunctionSchedule1Permission                        -
CREATE_COMPLETE                                             AWS::CloudFormation::Stack                                  db-startup-shutdown-lambda-stack                            -
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Successfully created/updated stack - db-startup-shutdown-lambda-stack in None
----

- Cleanup

[console.source]
----
ğœ† aws cloudformation delete-stack --profile personal --stack-name db-startup-shutdown-lambda-stack

ğœ† aws rds delete-db-instance --profile personal --db-instance-identifier db-startup-shutdown-lambda-mysql --skip-final-snapshot

ğœ† aws s3 rb --profile personal s3://db-startup-shutdown-lambda-bucket --force
----

- Settings

** Project name: `db-startup-shutdown-lambda`
** Code Pipeline name: `db-startup-shutdown-lambda-pipeline`
** Code Pipeline role: `AWSCodePipelineServiceRole-db-startup-shutdown-lambda`
** Code Build role: `codebuild-db-startup-shutdown-lambda-service-role`
** Code Build policy: `codebuild-db-startup-shutdown-lambda-service-policy`
** Cloudformation role: `cfn-db-startup-shutdown-lambda-pipeline-role`
** Cloudformation policy: `cfn-db-startup-shutdown-lambda-pipeline-policy`
** Cloudformation stack name: `db-startup-shutdown-lambda-stack`
** Cloudformation changeset name: `db-startup-shutdown-lambda-changeset`


AWS CDK and Cloudformation
--------------------------

Set up Github repo in Parameter Store in AWS Systems Manager.

[console.source]
----
ğœ† aws ssm put-parameter --profile personal --name /db-startup-shutdown-lambda/github/repo  --description "Github Repository Name" --type String --value db-startup-shutdown-lambda
ğœ† aws ssm put-parameter --profile personal --name /db-startup-shutdown-lambda/github/owner --description "Github Owner Name"      --type String --value BillSalvor
----

Add Github Token in AWS Secret Manager.

[console.source]
----
ğœ† aws secretsmanager create-secret --profile personal --name /db-startup-shutdown-lambda/github/token --secret-string '{"github-token":"m1209dal90321e1a9023r09152easf92k2820827ff08"}'
----

Run CDK to deploy Lambda and its Pipeline stacks.

[console.source]
----
ğœ† cdk deploy LambdaPipelineStack --profile personal
This deployment will make potentially sensitive changes according to your current security approval level (--require-approval broadening).
Please confirm you intend to make the following modifications:

IAM Statement Changes
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚ Resource                                                           â”‚ Effect â”‚ Action                                                             â”‚ Principal                                                           â”‚ Condition â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${Build.Arn}                                                       â”‚ Allow  â”‚ codebuild:BatchGetBuilds                                           â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineA â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ codebuild:StartBuild                                               â”‚ ctionRole}                                                          â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ codebuild:StopBuild                                                â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${Build/Role.Arn}                                                  â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ Service:codebuild.amazonaws.com                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${ShutdownLambdaBuild.Arn}                                         â”‚ Allow  â”‚ codebuild:BatchGetBuilds                                           â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Bui â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ codebuild:StartBuild                                               â”‚ ld/CodePipelineActionRole}                                          â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ codebuild:StopBuild                                                â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${ShutdownLambdaBuild/Role.Arn}                                    â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ Service:codebuild.amazonaws.com                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${StartupLambdaBuild.Arn}                                          â”‚ Allow  â”‚ codebuild:BatchGetBuilds                                           â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Buil â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ codebuild:StartBuild                                               â”‚ d/CodePipelineActionRole}                                           â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ codebuild:StopBuild                                                â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${StartupLambdaBuild/Role.Arn}                                     â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ Service:codebuild.amazonaws.com                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}         â”‚ Allow  â”‚ s3:Abort*                                                          â”‚ AWS:${Build/Role}                                                   â”‚           â”‚
â”‚   â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}/*       â”‚        â”‚ s3:DeleteObject*                                                   â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetBucket*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:List*                                                           â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:PutObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}         â”‚ Allow  â”‚ s3:Abort*                                                          â”‚ AWS:${ShutdownLambdaBuild/Role}                                     â”‚           â”‚
â”‚   â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}/*       â”‚        â”‚ s3:DeleteObject*                                                   â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetBucket*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:List*                                                           â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:PutObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}         â”‚ Allow  â”‚ s3:Abort*                                                          â”‚ AWS:${StartupLambdaBuild/Role}                                      â”‚           â”‚
â”‚   â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}/*       â”‚        â”‚ s3:DeleteObject*                                                   â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetBucket*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:List*                                                           â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:PutObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}         â”‚ Allow  â”‚ s3:Abort*                                                          â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role}                     â”‚           â”‚
â”‚   â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}/*       â”‚        â”‚ s3:DeleteObject*                                                   â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetBucket*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:GetObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:List*                                                           â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:PutObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}         â”‚ Allow  â”‚ s3:GetBucket*                                                      â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelin â”‚           â”‚
â”‚   â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}/*       â”‚        â”‚ s3:GetObject*                                                      â”‚ eActionRole}                                                        â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:List*                                                           â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}         â”‚ Allow  â”‚ s3:GetBucket*                                                      â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role}       â”‚           â”‚
â”‚   â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucket.Arn}/*       â”‚        â”‚ s3:GetObject*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ s3:List*                                                           â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:CancelKeyDeletion                                              â”‚ AWS:arn:${AWS::Partition}:iam::755034721059:root                    â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Create*                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Delete*                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Describe*                                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Disable*                                                       â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Enable*                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey                                                â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Get*                                                           â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:List*                                                          â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Put*                                                           â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Revoke*                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ScheduleKeyDeletion                                            â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:TagResource                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:UntagResource                                                  â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Update*                                                        â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role.Arn}                 â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${StartupLambdaBuild/Role.Arn}                                  â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${StartupLambdaBuild/Role.Arn}                                  â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${ShutdownLambdaBuild/Role.Arn}                                 â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${ShutdownLambdaBuild/Role.Arn}                                 â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${Build/Role.Arn}                                               â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${Build/Role.Arn}                                               â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role.Arn}   â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelin â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚ eActionRole.Arn}                                                    â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${Build/Role}                                                   â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${Build/Role}                                                   â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${ShutdownLambdaBuild/Role}                                     â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${ShutdownLambdaBuild/Role}                                     â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${StartupLambdaBuild/Role}                                      â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${StartupLambdaBuild/Role}                                      â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role}                     â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:Encrypt                                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:GenerateDataKey*                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ kms:ReEncrypt*                                                     â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelin â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚ eActionRole}                                                        â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey â”‚ Allow  â”‚ kms:Decrypt                                                        â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role}       â”‚           â”‚
â”‚   â”‚ .Arn}                                                              â”‚        â”‚ kms:DescribeKey                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActi â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:arn:${AWS::Partition}:iam::755034721059:root                    â”‚           â”‚
â”‚   â”‚ onRole.Arn}                                                        â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActi â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role}                     â”‚           â”‚
â”‚   â”‚ onRole.Arn}                                                        â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/ â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:arn:${AWS::Partition}:iam::755034721059:root                    â”‚           â”‚
â”‚   â”‚ CodePipelineActionRole.Arn}                                        â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/ â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role}                     â”‚           â”‚
â”‚   â”‚ CodePipelineActionRole.Arn}                                        â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/C â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:arn:${AWS::Partition}:iam::755034721059:root                    â”‚           â”‚
â”‚   â”‚ odePipelineActionRole.Arn}                                         â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/C â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role}                     â”‚           â”‚
â”‚   â”‚ odePipelineActionRole.Arn}                                         â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineAc â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:arn:${AWS::Partition}:iam::755034721059:root                    â”‚           â”‚
â”‚   â”‚ tionRole.Arn}                                                      â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineAc â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Role}                     â”‚           â”‚
â”‚   â”‚ tionRole.Arn}                                                      â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role.Arn}      â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ Service:cloudformation.amazonaws.com                                â”‚           â”‚
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role.Arn}      â”‚ Allow  â”‚ iam:PassRole                                                       â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelin â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚                                                                    â”‚ eActionRole}                                                        â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ ${db-startup-shutdown-lambda-pipeline/Role.Arn}                    â”‚ Allow  â”‚ sts:AssumeRole                                                     â”‚ Service:codepipeline.amazonaws.com                                  â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ *                                                                  â”‚ Allow  â”‚ *                                                                  â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role}       â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ arn:${AWS::Partition}:cloudformation:ap-southeast-2:755034721059:s â”‚ Allow  â”‚ cloudformation:CreateStack                                         â”‚ AWS:${db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelin â”‚           â”‚
â”‚   â”‚ tack/LambdaDeploymentStack/*                                       â”‚        â”‚ cloudformation:DescribeStack*                                      â”‚ eActionRole}                                                        â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ cloudformation:GetStackPolicy                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ cloudformation:GetTemplate*                                        â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ cloudformation:SetStackPolicy                                      â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ cloudformation:UpdateStack                                         â”‚                                                                     â”‚           â”‚
â”‚   â”‚                                                                    â”‚        â”‚ cloudformation:ValidateTemplate                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ arn:${AWS::Partition}:logs:ap-southeast-2:755034721059:log-group:/ â”‚ Allow  â”‚ logs:CreateLogGroup                                                â”‚ AWS:${Build/Role}                                                   â”‚           â”‚
â”‚   â”‚ aws/codebuild/${Build45A36621}                                     â”‚        â”‚ logs:CreateLogStream                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚ arn:${AWS::Partition}:logs:ap-southeast-2:755034721059:log-group:/ â”‚        â”‚ logs:PutLogEvents                                                  â”‚                                                                     â”‚           â”‚
â”‚   â”‚ aws/codebuild/${Build45A36621}:*                                   â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ arn:${AWS::Partition}:logs:ap-southeast-2:755034721059:log-group:/ â”‚ Allow  â”‚ logs:CreateLogGroup                                                â”‚ AWS:${ShutdownLambdaBuild/Role}                                     â”‚           â”‚
â”‚   â”‚ aws/codebuild/${ShutdownLambdaBuild9326338E}                       â”‚        â”‚ logs:CreateLogStream                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚ arn:${AWS::Partition}:logs:ap-southeast-2:755034721059:log-group:/ â”‚        â”‚ logs:PutLogEvents                                                  â”‚                                                                     â”‚           â”‚
â”‚   â”‚ aws/codebuild/${ShutdownLambdaBuild9326338E}:*                     â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + â”‚ arn:${AWS::Partition}:logs:ap-southeast-2:755034721059:log-group:/ â”‚ Allow  â”‚ logs:CreateLogGroup                                                â”‚ AWS:${StartupLambdaBuild/Role}                                      â”‚           â”‚
â”‚   â”‚ aws/codebuild/${StartupLambdaBuildFE5711B9}                        â”‚        â”‚ logs:CreateLogStream                                               â”‚                                                                     â”‚           â”‚
â”‚   â”‚ arn:${AWS::Partition}:logs:ap-southeast-2:755034721059:log-group:/ â”‚        â”‚ logs:PutLogEvents                                                  â”‚                                                                     â”‚           â”‚
â”‚   â”‚ aws/codebuild/${StartupLambdaBuildFE5711B9}:*                      â”‚        â”‚                                                                    â”‚                                                                     â”‚           â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
(NOTE: There may be security-related changes not in this list. See https://github.com/aws/aws-cdk/issues/1299)

Do you wish to deploy these changes (y/n)? y
LambdaPipelineStack: deploying...
LambdaPipelineStack: creating CloudFormation changeset...
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleB7442153)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | Build/Role (BuildRoleB7C66CB2)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole (dbstartupshutdownlambdapipelineDeployCodePipelineActionRole47B02DD0)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role (dbstartupshutdownlambdapipelineDeployRole833B7F9D)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildCodePipelineActionRole6C038142)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleA22EDA1D)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Role (dbstartupshutdownlambdapipelineRoleF60B30C8)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | ShutdownLambdaBuild/Role (ShutdownLambdaBuildRole802FA553)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::CDK::Metadata          | CDKMetadata
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | StartupLambdaBuild/Role (StartupLambdaBuildRole6475D410)
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleB7442153) Resource creation Initiated
  0/28 | 11:45:37 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | Build/Role (BuildRoleB7C66CB2) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole (dbstartupshutdownlambdapipelineDeployCodePipelineActionRole47B02DD0) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Role (dbstartupshutdownlambdapipelineRoleF60B30C8) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role (dbstartupshutdownlambdapipelineDeployRole833B7F9D) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleA22EDA1D) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | StartupLambdaBuild/Role (StartupLambdaBuildRole6475D410) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | ShutdownLambdaBuild/Role (ShutdownLambdaBuildRole802FA553) Resource creation Initiated
  0/28 | 11:45:38 AM | CREATE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildCodePipelineActionRole6C038142) Resource creation Initiated
  0/28 | 11:45:39 AM | CREATE_IN_PROGRESS   | AWS::CDK::Metadata          | CDKMetadata Resource creation Initiated
  1/28 | 11:45:39 AM | CREATE_COMPLETE      | AWS::CDK::Metadata          | CDKMetadata
  2/28 | 11:45:54 AM | CREATE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleB7442153)
  3/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | Build/Role (BuildRoleB7C66CB2)
  4/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Role (dbstartupshutdownlambdapipelineRoleF60B30C8)
  5/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleA22EDA1D)
  6/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role (dbstartupshutdownlambdapipelineDeployRole833B7F9D)
  7/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | StartupLambdaBuild/Role (StartupLambdaBuildRole6475D410)
  8/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildCodePipelineActionRole6C038142)
  9/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole (dbstartupshutdownlambdapipelineDeployCodePipelineActionRole47B02DD0)
 10/28 | 11:45:55 AM | CREATE_COMPLETE      | AWS::IAM::Role              | ShutdownLambdaBuild/Role (ShutdownLambdaBuildRole802FA553)
 10/28 | 11:45:59 AM | CREATE_IN_PROGRESS   | AWS::KMS::Key               | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKey26412A87)
 10/28 | 11:46:00 AM | CREATE_IN_PROGRESS   | AWS::KMS::Key               | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKey26412A87) Resource creation Initiated
10/28 Currently in progress: dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKey26412A87
 11/28 | 11:47:00 AM | CREATE_COMPLETE      | AWS::KMS::Key               | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKey26412A87)
 11/28 | 11:47:03 AM | CREATE_IN_PROGRESS   | AWS::CodeBuild::Project     | ShutdownLambdaBuild (ShutdownLambdaBuild9326338E)
 11/28 | 11:47:03 AM | CREATE_IN_PROGRESS   | AWS::S3::Bucket             | db-startup-shutdown-lambda-pipeline/ArtifactsBucket (dbstartupshutdownlambdapipelineArtifactsBucketB3624C5C)
 11/28 | 11:47:03 AM | CREATE_IN_PROGRESS   | AWS::CodeBuild::Project     | Build (Build45A36621)
 11/28 | 11:47:03 AM | CREATE_IN_PROGRESS   | AWS::KMS::Alias             | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKeyAlias (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKeyAliasF4CE81D8)
 11/28 | 11:47:04 AM | CREATE_IN_PROGRESS   | AWS::CodeBuild::Project     | StartupLambdaBuild (StartupLambdaBuildFE5711B9)
 11/28 | 11:47:05 AM | CREATE_IN_PROGRESS   | AWS::S3::Bucket             | db-startup-shutdown-lambda-pipeline/ArtifactsBucket (dbstartupshutdownlambdapipelineArtifactsBucketB3624C5C) Resource creation Initiated
 11/28 | 11:47:05 AM | CREATE_IN_PROGRESS   | AWS::CodeBuild::Project     | ShutdownLambdaBuild (ShutdownLambdaBuild9326338E) Resource creation Initiated
 11/28 | 11:47:05 AM | CREATE_IN_PROGRESS   | AWS::CodeBuild::Project     | Build (Build45A36621) Resource creation Initiated
 12/28 | 11:47:06 AM | CREATE_COMPLETE      | AWS::CodeBuild::Project     | ShutdownLambdaBuild (ShutdownLambdaBuild9326338E)
 13/28 | 11:47:06 AM | CREATE_COMPLETE      | AWS::CodeBuild::Project     | Build (Build45A36621)
 13/28 | 11:47:06 AM | CREATE_IN_PROGRESS   | AWS::CodeBuild::Project     | StartupLambdaBuild (StartupLambdaBuildFE5711B9) Resource creation Initiated
 14/28 | 11:47:07 AM | CREATE_COMPLETE      | AWS::CodeBuild::Project     | StartupLambdaBuild (StartupLambdaBuildFE5711B9)
 14/28 | 11:47:09 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleDefaultPolicy67B407EE)
 14/28 | 11:47:10 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildCodePipelineActionRoleDefaultPolicyF0B383A2)
 14/28 | 11:47:10 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleDefaultPolicy67B407EE) Resource creation Initiated
 14/28 | 11:47:10 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleDefaultPolicy6A61708F)
 14/28 | 11:47:11 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildCodePipelineActionRoleDefaultPolicyF0B383A2) Resource creation Initiated
 14/28 | 11:47:11 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleDefaultPolicy6A61708F) Resource creation Initiated
 15/28 | 11:47:25 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleDefaultPolicy67B407EE)
 16/28 | 11:47:27 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildCodePipelineActionRoleDefaultPolicyF0B383A2)
 17/28 | 11:47:27 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleDefaultPolicy6A61708F)
 18/28 | 11:47:28 AM | CREATE_COMPLETE      | AWS::S3::Bucket             | db-startup-shutdown-lambda-pipeline/ArtifactsBucket (dbstartupshutdownlambdapipelineArtifactsBucketB3624C5C)
 18/28 | 11:47:30 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineDeployCodePipelineActionRoleDefaultPolicy9254960B)
 18/28 | 11:47:30 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | ShutdownLambdaBuild/Role/DefaultPolicy (ShutdownLambdaBuildRoleDefaultPolicy857D5281)
 18/28 | 11:47:30 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | Build/Role/DefaultPolicy (BuildRoleDefaultPolicyEAC4E6D6)
 18/28 | 11:47:31 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role/DefaultPolicy (dbstartupshutdownlambdapipelineDeployRoleDefaultPolicy7429A6F9)
 18/28 | 11:47:31 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | StartupLambdaBuild/Role/DefaultPolicy (StartupLambdaBuildRoleDefaultPolicyA04B91B3)
 18/28 | 11:47:31 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineDeployCodePipelineActionRoleDefaultPolicy9254960B) Resource creation Initiated
 18/28 | 11:47:31 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Role/DefaultPolicy (dbstartupshutdownlambdapipelineRoleDefaultPolicy61B51497)
 18/28 | 11:47:31 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | ShutdownLambdaBuild/Role/DefaultPolicy (ShutdownLambdaBuildRoleDefaultPolicy857D5281) Resource creation Initiated
 18/28 | 11:47:32 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | Build/Role/DefaultPolicy (BuildRoleDefaultPolicyEAC4E6D6) Resource creation Initiated
 18/28 | 11:47:32 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | StartupLambdaBuild/Role/DefaultPolicy (StartupLambdaBuildRoleDefaultPolicyA04B91B3) Resource creation Initiated
 18/28 | 11:47:32 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role/DefaultPolicy (dbstartupshutdownlambdapipelineDeployRoleDefaultPolicy7429A6F9) Resource creation Initiated
 18/28 | 11:47:33 AM | CREATE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Role/DefaultPolicy (dbstartupshutdownlambdapipelineRoleDefaultPolicy61B51497) Resource creation Initiated
 19/28 | 11:47:47 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | ShutdownLambdaBuild/Role/DefaultPolicy (ShutdownLambdaBuildRoleDefaultPolicy857D5281)
 20/28 | 11:47:47 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineDeployCodePipelineActionRoleDefaultPolicy9254960B)
 21/28 | 11:47:47 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | Build/Role/DefaultPolicy (BuildRoleDefaultPolicyEAC4E6D6)
 22/28 | 11:47:47 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | StartupLambdaBuild/Role/DefaultPolicy (StartupLambdaBuildRoleDefaultPolicyA04B91B3)
 23/28 | 11:47:48 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role/DefaultPolicy (dbstartupshutdownlambdapipelineDeployRoleDefaultPolicy7429A6F9)
 24/28 | 11:47:48 AM | CREATE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Role/DefaultPolicy (dbstartupshutdownlambdapipelineRoleDefaultPolicy61B51497)
 24/28 | 11:47:52 AM | CREATE_IN_PROGRESS   | AWS::CodePipeline::Pipeline | db-startup-shutdown-lambda-pipeline (dbstartupshutdownlambdapipelineBD8B13CE)
 24/28 | 11:47:53 AM | CREATE_IN_PROGRESS   | AWS::CodePipeline::Pipeline | db-startup-shutdown-lambda-pipeline (dbstartupshutdownlambdapipelineBD8B13CE) Resource creation Initiated
 25/28 | 11:47:54 AM | CREATE_COMPLETE      | AWS::CodePipeline::Pipeline | db-startup-shutdown-lambda-pipeline (dbstartupshutdownlambdapipelineBD8B13CE)
 25/28 | 11:47:56 AM | CREATE_IN_PROGRESS   | AWS::CodePipeline::Webhook  | db-startup-shutdown-lambda-pipeline/Source/Source/WebhookResource (dbstartupshutdownlambdapipelineSourceWebhookResourceC0040080)
 25/28 | 11:47:59 AM | CREATE_IN_PROGRESS   | AWS::CodePipeline::Webhook  | db-startup-shutdown-lambda-pipeline/Source/Source/WebhookResource (dbstartupshutdownlambdapipelineSourceWebhookResourceC0040080) Resource creation Initiated
 26/28 | 11:47:59 AM | CREATE_COMPLETE      | AWS::CodePipeline::Webhook  | db-startup-shutdown-lambda-pipeline/Source/Source/WebhookResource (dbstartupshutdownlambdapipelineSourceWebhookResourceC0040080)

 âœ…  LambdaPipelineStack

Stack ARN:
arn:aws:cloudformation:ap-southeast-2:755034721059:stack/LambdaPipelineStack/88a87470-6331-11ea-b9b8-0aa5d4eec80a
----

Destroy Lambda and its Pipeline stacks.

[console.source]
----
ğœ† cdk destroy LambdaPipelineStack --profile int-sandpit
Are you sure you want to delete: LambdaPipelineStack (y/n)? y
LambdaPipelineStack: destroying...
   0 | 11:55:13 AM | DELETE_IN_PROGRESS   | AWS::CloudFormation::Stack  | LambdaPipelineStack User Initiated
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::CDK::Metadata          | CDKMetadata
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildCodePipelineActionRoleDefaultPolicyF0B383A2)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleDefaultPolicy6A61708F)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | StartupLambdaBuild/Role/DefaultPolicy (StartupLambdaBuildRoleDefaultPolicyA04B91B3)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role/DefaultPolicy (dbstartupshutdownlambdapipelineDeployRoleDefaultPolicy7429A6F9)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::KMS::Alias             | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKeyAlias (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKeyAliasF4CE81D8)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineDeployCodePipelineActionRoleDefaultPolicy9254960B)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::CodePipeline::Webhook  | db-startup-shutdown-lambda-pipeline/Source/Source/WebhookResource (dbstartupshutdownlambdapipelineSourceWebhookResourceC0040080)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | ShutdownLambdaBuild/Role/DefaultPolicy (ShutdownLambdaBuildRoleDefaultPolicy857D5281)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleDefaultPolicy67B407EE)
   0 | 11:55:16 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | Build/Role/DefaultPolicy (BuildRoleDefaultPolicyEAC4E6D6)
   1 | 11:55:16 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildCodePipelineActionRoleDefaultPolicyF0B383A2)
   2 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | StartupLambdaBuild/Role/DefaultPolicy (StartupLambdaBuildRoleDefaultPolicyA04B91B3)
   3 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleDefaultPolicy6A61708F)
   4 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineDeployCodePipelineActionRoleDefaultPolicy9254960B)
   5 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Deploy/Deploy/Role/DefaultPolicy (dbstartupshutdownlambdapipelineDeployRoleDefaultPolicy7429A6F9)
   6 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole/DefaultPolicy (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleDefaultPolicy67B407EE)
   7 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | ShutdownLambdaBuild/Role/DefaultPolicy (ShutdownLambdaBuildRoleDefaultPolicy857D5281)
   8 | 11:55:17 AM | DELETE_COMPLETE      | AWS::CDK::Metadata          | CDKMetadata
   9 | 11:55:17 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | Build/Role/DefaultPolicy (BuildRoleDefaultPolicyEAC4E6D6)
  10 | 11:55:18 AM | DELETE_COMPLETE      | AWS::CodePipeline::Webhook  | db-startup-shutdown-lambda-pipeline/Source/Source/WebhookResource (dbstartupshutdownlambdapipelineSourceWebhookResourceC0040080)
  10 | 11:55:19 AM | DELETE_IN_PROGRESS   | AWS::CodePipeline::Pipeline | db-startup-shutdown-lambda-pipeline (dbstartupshutdownlambdapipelineBD8B13CE)
  11 | 11:55:20 AM | DELETE_COMPLETE      | AWS::CodePipeline::Pipeline | db-startup-shutdown-lambda-pipeline (dbstartupshutdownlambdapipelineBD8B13CE)
  11 | 11:55:20 AM | DELETE_IN_PROGRESS   | AWS::CodeBuild::Project     | Build (Build45A36621)
  11 | 11:55:20 AM | DELETE_IN_PROGRESS   | AWS::CodeBuild::Project     | ShutdownLambdaBuild (ShutdownLambdaBuild9326338E)
  11 | 11:55:20 AM | DELETE_IN_PROGRESS   | AWS::CodeBuild::Project     | StartupLambdaBuild (StartupLambdaBuildFE5711B9)
  11 | 11:55:20 AM | DELETE_IN_PROGRESS   | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Role/DefaultPolicy (dbstartupshutdownlambdapipelineRoleDefaultPolicy61B51497)
  12 | 11:55:21 AM | DELETE_COMPLETE      | AWS::IAM::Policy            | db-startup-shutdown-lambda-pipeline/Role/DefaultPolicy (dbstartupshutdownlambdapipelineRoleDefaultPolicy61B51497)
  13 | 11:55:22 AM | DELETE_COMPLETE      | AWS::CodeBuild::Project     | ShutdownLambdaBuild (ShutdownLambdaBuild9326338E)
  14 | 11:55:22 AM | DELETE_COMPLETE      | AWS::CodeBuild::Project     | Build (Build45A36621)
  14 | 11:55:22 AM | DELETE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildCodePipelineActionRole6C038142)
  14 | 11:55:22 AM | DELETE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleA22EDA1D)
  14 | 11:55:22 AM | DELETE_IN_PROGRESS   | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleB7442153)
  14 | 11:55:22 AM | DELETE_SKIPPED       | AWS::S3::Bucket             | db-startup-shutdown-lambda-pipeline/ArtifactsBucket (dbstartupshutdownlambdapipelineArtifactsBucketB3624C5C)
  15 | 11:55:23 AM | DELETE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildCodePipelineActionRole6C038142)
  16 | 11:55:24 AM | DELETE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Startup_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildStartupLambdaBuildCodePipelineActionRoleB7442153)
  17 | 11:55:24 AM | DELETE_COMPLETE      | AWS::IAM::Role              | db-startup-shutdown-lambda-pipeline/Build/Shutdown_Lambda_Build/CodePipelineActionRole (dbstartupshutdownlambdapipelineBuildShutdownLambdaBuildCodePipelineActionRoleA22EDA1D)
  18 | 11:55:29 AM | DELETE_COMPLETE      | AWS::CodeBuild::Project     | StartupLambdaBuild (StartupLambdaBuildFE5711B9)
 18 Currently in progress: LambdaPipelineStack, dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKeyAliasF4CE81D8
  19 | 11:56:16 AM | DELETE_COMPLETE      | AWS::KMS::Alias             | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKeyAlias (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKeyAliasF4CE81D8)
  19 | 11:56:17 AM | DELETE_IN_PROGRESS   | AWS::KMS::Key               | db-startup-shutdown-lambda-pipeline/ArtifactsBucketEncryptionKey (dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKey26412A87)
 19 Currently in progress: LambdaPipelineStack, dbstartupshutdownlambdapipelineArtifactsBucketEncryptionKey26412A87

 âœ…  LambdaPipelineStack: destroyed
----


References
----------

- Saving money by automatically shutting down RDS instances using AWS Lambda and AWS SAM, _https://medium.com/hatchsoftware/saving-money-by-automatically-shutting-down-rds-instances-using-aws-lambda-and-aws-sam-925fd86592b5_
- Setting up CI/CD for Lambda Functions using AWS CodePipeline, _https://medium.com/hatchsoftware/setting-up-ci-cd-for-lambda-functions-using-aws-codepipeline-880567769dde_
- Using the AWS CDK to build scheduled Lambda Functions, _https://medium.com/hatchsoftware/using-the-aws-cdk-to-build-scheduled-lambda-functions-13eb1674586e_

- AWS CDK setup for autoscaling with ec2 spot instances, _https://jelinden.fi/blog/aws-cdk-setup-for-autoscaling-with-ec2-spot-instances/xi7mNppZg_

- AWS CDK Part 1: How to create a custom VPC, _https://github.com/BillSalvor/db-startup-shutdown-lambda.git_
- AWS CDK Part 2: How to create an S3 Bucket, _https://blog.codecentric.de/en/2019/10/aws-cdk-part-2-s3-bucket/_
- AWS CDK Part 3: How to create an RDS instance, _https://blog.codecentric.de/en/2019/11/aws-cdk-part-3-how-to-create-an-rds-instance/_
- AWS CDK Part 4: How to create Lambdas, _https://blog.codecentric.de/en/2019/11/aws-cdk-part-4-create-lambdas/_
- AWS CDK Part 5: How to create a step function, _https://blog.codecentric.de/en/2019/11/aws-cdk-part-5-create-step-functions/_
- AWS CDK Part 6: Lessons learned, _https://blog.codecentric.de/en/2019/11/aws-cdk-part-6-lessons-learned/_